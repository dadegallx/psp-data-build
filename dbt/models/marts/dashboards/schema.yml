version: 2

models:
  - name: mart_indicators
    description: >
      **Detailed indicator-level data with context for drill-down analysis.**

      **Grain:** One row per family per indicator per snapshot

      **Use Case:** Detailed analysis of specific indicators, dimension breakdowns,
      and understanding which indicators drive poverty status.

      **Key Features:**
      - Pre-calculated integer flags (is_red, is_yellow, is_green, is_skipped) for easy aggregation
      - Canonical English indicator_name for cross-survey grouping
      - Localized indicator text for display
      - Color criteria descriptions for tooltips and explanation

      **BI Usage Patterns:**
      - Most critical indicators: GROUP BY indicator_name, SUM(is_red) DESC
      - Dimension analysis: GROUP BY dimension_name, aggregate status flags
      - Indicator detail: Filter to specific indicator_name, show localized text
      - Progress tracking: Compare status flags across snapshot_year

    columns:
      - name: snapshot_id
        description: "Unique identifier for this family snapshot"
        data_tests:
          - not_null

      - name: family_id
        description: "Unique family identifier"
        data_tests:
          - not_null

      - name: indicator_name
        description: >
          **PRIMARY GROUPING FIELD** - Canonical English indicator name.
          Use for aggregation across surveys regardless of language.

      - name: dimension_name
        description: "Poverty dimension category (e.g., Housing, Health, Education)"

      - name: is_red
        description: "1 if critical poverty, 0 otherwise. Use SUM() to count reds."
        data_tests:
          - accepted_values:
              values: [0, 1]

      - name: is_yellow
        description: "1 if vulnerable/moderate poverty, 0 otherwise. Use SUM() to count yellows."
        data_tests:
          - accepted_values:
              values: [0, 1]

      - name: is_green
        description: "1 if non-poor/need met, 0 otherwise. Use SUM() to count greens."
        data_tests:
          - accepted_values:
              values: [0, 1]

      - name: is_skipped
        description: "1 if indicator was skipped/not applicable, 0 otherwise."
        data_tests:
          - accepted_values:
              values: [0, 1]

      - name: has_followup_data
        description: "True if family has more than one snapshot (for cohort/longitudinal analysis)"
